<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3&amp;sensor=false"></script> -->

     <!-- <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_lBe2BBKUMic9F1rgYXvNtK6D0EIGv9o&signed_in=true&callback=initMap"></script> -->
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyA_lBe2BBKUMic9F1rgYXvNtK6D0EIGv9o"></script> 

    <script type="text/javascript" src="js/infobox.js"></script>
    <script type="text/javascript" src="js/jquery-3.1.0.js"></script>
    <script type="text/javascript" src="js/jquery.popupoverlay.js"></script>
    <script type="text/javascript">
    

      function initialize() {
        var secheltLoc = new google.maps.LatLng(35.666123,139.733916);

        var myMapOptions = {
           zoom: 15
          ,center: secheltLoc
          ,mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var theMap = new google.maps.Map(document.getElementById("map_canvas"), myMapOptions);

        
		var icon = "images/icon.png"

        var marker = new google.maps.Marker({
          map: theMap,
          position: new google.maps.LatLng(35.666123,139.733916),
          visible: true,
          icon: icon
        });

        var viewport = {
    		width  : $(window).width(),
    		height : $(window).height()
		};

        // var boxText = document.createElement("div");
        // boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background: yellow; padding: 5px;";
        // boxText.innerHTML = "<h1>株式会社ティレックス</h1>";

        var infoWindowHtml = 
        "<div id='content_wrapper'>"
	        +"<div id='infoWin'>"
		        +"<div>"
		        	+"<h1 style=''>T.Rex Trading Inc.</h1>"
		        	+"<blockquote>Lots of Missions.</blockquote>"
		          // +"<h3>Contact Us</h3>     <a href='mailto:info@trext.tokyo'>info@trext.tokyo</a>"
		        	+"<p>#223 4-3-11, Roppongi Minato, Tokyo Japan 1060032</p>"
		        	// +"<h3>CEO</h3><p>Shinichi Watanabe</p>"
		        +"</div>"
		        // +"<a href='mailto:info@trext.tokyo'><img src='images/mail.svg'></a>"
		        // +"<a href='#'><h3>Business</h3></a>"
		        +"<a href='mailto:test@test.com'>"
			        +"<div id='mail_icon'>"
			        +"</div>"
		        +"</a>"
	        +"</div>"

	     //    +"<div id='more'>"
			   //  +"</div>"
				  //   +"<h2>Business</h2>"
				  //   +"<ul>"
				  //   	+"<li>Blanket</li>"
				  //   	+"<li>Mattress & Pillow</li>"
				  //   	+"<li>Sheets & Pillow case</li>"
				  //   	+"<li>Sheets</li>"
				  //   	+"<li>Other accessaries</li>"
				  //   	+"<li>Skin care oil</li>"
				  //   	+"<li>A sales consultant</li>"
				  //   	+"<li>Logistics</li>"
				  //   	+"<li>Solar power station</li>"
				  //   +"</ul>"
			   //  +"</div>"
		    // +"</div>"
		+"</div> <!-- Close content_wrapper -->"


        var pxOffX;
        var pxOffY;

        var mobileWidth = 768;
        var infoWinWidth, infoWinHeight;

        if(viewport.width < mobileWidth){
        	pxOffX = -(viewport.width/2); //it moves infowindow when you move the map
        	pxOffY = -(viewport.height/1.6);
        	infoWinWidth = viewport.width
        	infoWinHeight = viewport.height/2;
        	// document.getElementById("infoWin").style.fontSize = "200%";
        }else if(viewport.width >= mobileWidth){
        	pxOffX = -310;
        	pxOffY = -340;
        	infoWinWidth = 280
        	infoWinHeight = infoWinWidth *1.25; //It is calculating height 
        }


        // console.log(toString(infoWinWidth) + "px");
        console.log(infoWinWidth.toString() + "px");

        var myOptions = {
           content: infoWindowHtml
          ,disableAutoPan: false
          ,maxWidth: 0
          ,pixelOffset: new google.maps.Size(pxOffX, pxOffY) //You can fix postion of info window
          ,zIndex: null
          ,boxStyle: { 
            background: "url('images/white.jpg')"
            ,opacity: 0.90
            ,width: infoWinWidth.toString() + "px"
            ,height: infoWinHeight.toString() + "px"　//This is the width of the window.
           }
          ,infoBoxClearance: new google.maps.Size(1, 1)
          ,isHidden: false
          ,pane: "floatPane"
          ,enableEventPropagation: false
        };

        // console.log(myOptions.boxStyle.width);

        //Add icon click function
        google.maps.event.addListener(marker, "click", function (e) {
          ib.open(theMap, this);
          map.setCenter(marker.getPosition());
        });
        console.log("marker.getPosition() = " + marker.getPosition());

        var ib = new InfoBox(myOptions);

        ib.open(theMap, marker);

        theMap.panBy(pxOffX/2,pxOffY/2);
      }
    </script>
    <!-- <script type="text/javascript" src="js/vex.js"></script> -->

    <title>T.REX Inc.</title>
  </head>

  <body onload="initialize()">
    <div id="map_canvas" style="width: 100%; height: 100%"></div>
    <script>
    	$(document).ready(function() {
      		$('#more').popup();
	    });
    </script>
  </body>

</html>
